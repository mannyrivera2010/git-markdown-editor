<!DOCTYPE html>
<html lang="en">

<head>
    <title>GitMarkdown</title>
    <link rel="stylesheet" href="/static/tailwind.min.css">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="/static/htmx.min.js"></script>
    <!-- <link rel="stylesheet" href="/static/style.css"> -->
</head>

<body hx-boost="true" class="bg-gray-100 text-gray-800 font-sans min-h-screen p-8">
    <div class="max-w-7xl mx-auto grid grid-cols-1 md:grid-cols-4 gap-8">
        <div class="md:col-span-1 space-y-4">
            <div class="bg-white rounded-lg shadow-sm border border-gray-200 p-4">
                <h3 class="font-bold text-gray-700 mb-2 border-b pb-2">Toolbox</h3>
                <div class="grid grid-cols-2 gap-2">
                    {{.Toolbox}}
                    <form id="upload-form" hx-encoding="multipart/form-data" hx-post="/upload" hx-target="#workspace"
                        hx-swap="innerHTML">
                        <input type="file" name="image" class="w-full text-xs p-1 border rounded">
                        <input type="hidden" name="file" value="{{.CurrentFile}}">
                        <button
                            class="w-full bg-yellow-50 text-yellow-600 text-xs font-semibold py-2 rounded hover:bg-yellow-100 mt-2">+
                            Picture</button>
                    </form>
                </div>
            </div>
            <div class="bg-white rounded-lg shadow-sm border border-gray-200 p-4 h-96 flex flex-col">
                <h3 class="font-bold text-gray-700 mb-4 border-b pb-2">Files</h3>
                <form hx-post="/file/create" hx-target="#file-tree" class="flex gap-2 mb-4"><input name="filename"
                        placeholder="New .md file" class="w-full text-xs p-1 border rounded"><button
                        class="bg-indigo-50 text-indigo-600 px-2 py-1 rounded text-xs">+</button></form>
                <div class="flex items-center mb-4"><input type="checkbox" id="recurse" name="recursive" value="true"
                        hx-get="/tree" hx-target="#file-tree" class="w-4 h-4 text-indigo-600"><label for="recurse"
                        class="ml-2 text-sm font-medium text-gray-900">Recursive</label></div>
                <div id="file-tree" class="overflow-y-auto flex-grow">{{ .FileTree }}</div>
            </div>
        </div>
        <div class="md:col-span-2 space-y-8">
            <div class="bg-white p-4 rounded-xl shadow-sm border border-gray-200 flex justify-between items-center">
                <h1 class="font-bold text-gray-700">File: {{ .CurrentFile }}</h1>
                <div class="flex space-x-2 items-center">
                    <div class="inline-flex rounded-md shadow-sm" role="group">
                        <button type="button" hx-get="/{{.CurrentFile}}" hx-target="#workspace"
                            class="text-xs bg-white text-gray-700 px-3 py-1.5 rounded-l-md border border-gray-300 hover:bg-gray-100">Render</button>
                        <button type="button" hx-get="/raw?file={{.CurrentFile}}" hx-target="#workspace"
                            class="text-xs bg-white text-gray-700 px-3 py-1.5 rounded-r-md border border-gray-300 hover:bg-gray-100">Source</button>
                    </div>
                    <div class="w-px h-6 bg-gray-200 mx-2"></div>
                    <button id="diff-button" hx-get="/diff" hx-target="#diff-viewer"
                        class="text-xs bg-purple-50 text-purple-600 px-3 py-1.5 rounded border border-purple-100">Diff</button>
                    <form action="/logout" method="GET"><button
                            class="text-xs text-red-500 hover:underline">Logout</button></form>
                </div>
            </div>
            <div id="diff-viewer"
                class="empty:hidden bg-gray-900 text-gray-100 rounded-xl shadow-lg border border-gray-700 p-4 mb-4">
            </div>
            <div id="workspace">
                {{.Body}}
            </div>
        </div>
        <div class="md:col-span-1">
            <div id="git-history"
                class="bg-gray-50 rounded-lg p-4 border border-gray-200 text-xs font-mono text-gray-600 h-screen overflow-y-auto shadow-inner">
                <div class="flex justify-between items-center mb-4">
                    <h3 class="font-bold text-gray-400 uppercase tracking-wider">Activity</h3>
                    <div class="flex space-x-2">
                        <form action="/pull" method="POST"><button
                                class="text-xs bg-indigo-50 text-indigo-600 px-3 py-1.5 rounded">⬇ Pull</button></form>
                        <form action="/push" method="POST"><button
                                class="text-xs bg-indigo-50 text-indigo-600 px-3 py-1.5 rounded">⬆ Push</button></form>
                    </div>
                </div>
                <ul class="space-y-2">{{ range .GitLogs }}<li>{{ . }}</li>{{ end }}</ul>
            </div>
        </div>
    </div>
    <!-- <script src="/static/script.js" defer></script> -->

</body>

</html>